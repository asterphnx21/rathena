payo2,68,118,4	script	Fenrir's Assistant	10128,{
	mes "[Fenrir's Assistant]";
    if ($exp_boost_active == 1) {
        mes "The server-wide EXP and Drop Rate boost is currently active!";
        close;
    }

    mes "We are collecting donations to provide a server-wide EXP and Drop Rate boost!";
    mes "Please donate at least " + .min_donation + " Zeny.";
    next;
    mes "[Fenrir's Assistant]";
    mes "How much would you like to donate?";
    input .@donation;

    if (.@donation < .min_donation) {
        mes "The minimum donation is " + .min_donation + " Zeny.";
        close;
    }

    if (Zeny < .@donation) {
        mes "You do not have enough Zeny.";
        close;
    }
	// Deduct the donation from the player
    set Zeny, Zeny - .@donation;
	sc_start SC_INCREASEAGI, 1800000, 10; // Increase Agility level 10 for 30 minutes (1800 seconds)
	sc_start SC_BLESSING, 1800000, 10; // Blessing level 10 for 30 minutes (1800 seconds)
	sc_start SC_ANGELUS, 1800000, 10; // Angelus level 10 for 30 minutes (1800 seconds)
	announce "[" + strcharinfo(0) + "] donated 20,000 zeny to feed Fenrir's Frenzy", bc_all;
   
   // Add the donation to the total
    set $total_zeny_collected, $total_zeny_collected + .@donation;

    mes "Thank you for your donation!";
	if ($total_zeny_collected >= 5000000) {
        mes "The donation goal has been reached!";
        mes "The server-wide EXP and Drop Rate boost will be activated for 6 hours!";
        set $exp_boost_active, 1;
		set $total_zeny_collected, 0;
        donpcevent "Fenrir's Assistant::OnExpBoostStart";
   
   } else {
        mes "We have collected " + $total_zeny_collected + " Zeny so far.";
        mes "We need " + (500000 - $total_zeny_collected) + " more Zeny to reach our goal.";
    }
	close;
	
	OnInit: // executes on server restart and/or @reloadscript
		// Save original values
		.base_exp = getbattleflag("base_exp_rate");
		.job_exp = getbattleflag("job_exp_rate");
		.item_common = getbattleflag("item_rate_common");
		.item_equip = getbattleflag("item_rate_equip");
		.item_heal = getbattleflag("item_rate_heal");
		.item_use = getbattleflag("item_rate_use");
		.min_donation = 20000;
		.exp_boost_duration = 21600; // 6 hours in seconds
		$total_zeny_collected = 0; // Reset counters
		$exp_boost_active = 0;
		// Interval in seconds
		.interval = 1;
		while(1) {
		showscript "Fenrir's Fury: " + $total_zeny_collected + "/10,000,000", getnpcid(0);
		sleep 1000;
	}
		end;
		

	OnExpBoostStart:
        // Announce to the server
        announce "The Fenrir's Frenzy: EXP and Drop Rate boost has been activated for 6 hours!", bc_all;
		setbattleflag "base_exp_rate",600;
		setbattleflag "job_exp_rate",600;
		setbattleflag "item_rate_common",300;
		setbattleflag "item_rate_equip",300;
		setbattleflag "item_rate_heal",300;
		setbattleflag "item_rate_use",300,true;
		// Initialize the counter variable
		set .counter, 0;
		initnpctimer;
        end;

    OnTimer1000:
		// Increment the counter
		set .counter, .counter + 1;
		
        if (.counter >= .exp_boost_duration) {
			atcommand "@reloadbattleconf";

            // Reset the total collected Zeny and the boost status
            set $exp_boost_active, 0;

            // Announce to the server
            announce "The Fenrir's Frenzy: EXP and Drop Rate boost has ended.", bc_all;
			stopnpctimer;
			end;
        }
		// Restart the timer
		initnpctimer;
        end;
		
}

payo2,70,118,4	script	Fenrir's Soul	10295,{

	// Check if the player is a GM with group ID 99
	if (getgmlevel() != 99) {
		mes "[GM Access NPC]";
		mes "You do not have permission to access this NPC.";
		close;
	}

	// Display NPC options
	mes "[Fenrir's Soul]";
	mes "Welcome, GM!";
	mes "This is a console for Fenrir's Frenzy.";
	next;

	switch(select("Activate Fenrir's Frenzy!:Deactivate Fenrir's Frenzy:Cancel")) {
		case 1:
			mes "[Fenrir's Soul]";
			mes "Fenrir's Frenzy Activated.";
			setbattleflag "base_exp_rate",600;
			setbattleflag "job_exp_rate",600;
			setbattleflag "item_rate_common",300;
			setbattleflag "item_rate_equip",300;
			setbattleflag "item_rate_heal",300;
			setbattleflag "item_rate_use",300,true;
			set $exp_boost_active, 1;
			announce "The Fenrir's Frenzy: EXP and Drop Rate boost has been activated by a GM!", bc_all;
			close;
		case 2:
			mes "[Fenrir's Soul]";
			mes "Fenrir's Frenzy Deactivated.";
			// Add your 'Stop' functionality here
			atcommand "@reloadbattleconf";
			set $exp_boost_active, 0;
			announce "The Fenrir's Frenzy: EXP and Drop Rate boost has been deactivated by a GM!", bc_all;
			close;
		case 3:
			mes "[Fenrir's Soul]";
			mes "You chose to Cancel.";
			close;
		while(1) {
		showscript "Fenrir's Soul";
		sleep 1000;
	}
	}
}

-	script	Fenrir_Login	-1,{
OnPCLoginEvent:
		if ($exp_boost_active == 1) {
        dispbottom "Fenrir's Frenzy is currently activated. ";
		end;
    }
	}